import{R as t}from"./react-vendor-EfHycc-t.js";import{n as a,v as e,K as r,a as s}from"./index-CCg2rRgv.js";import{j as o}from"./ui-framework-nn7D7dv2.js";import{R as n,A as i,a as c,X as l,Y as p,T as d,L as m,g as h}from"./charts-Dom0rmuL.js";import"./icons-BXW-tQdz.js";import"./animations-DTB6hMKs.js";import"./database-Ch4ty5VL.js";const x=x=>{const{trades:u,onDataUpdate:f,selectedView:_}=x,{accountingMethod:y}=a(),D="cash"===y,{filter:j}=e(),C=t.useMemo(()=>"all"===j.type?u:u.filter(t=>r(t,j,D)),[u,j,D]),{getAllMonthlyTruePortfolios:g}=s(C),w=t.useMemo(()=>g(),[g,C,D]),{startDate:k,endDate:v}=t.useMemo(()=>{const t=(t=>{const a=[];return t.forEach(t=>{t.date&&a.push(new Date(t.date)),!D||"Closed"!==t.positionStatus&&"Partial"!==t.positionStatus||(t.exit1Date&&a.push(new Date(t.exit1Date)),t.exit2Date&&a.push(new Date(t.exit2Date)),t.exit3Date&&a.push(new Date(t.exit3Date)))}),a.filter(t=>!isNaN(t.getTime()))})(u).sort((t,a)=>t.getTime()-a.getTime());return{startDate:t[0]||new Date,endDate:t[t.length-1]||new Date}},[u,D]),z=t.useCallback((t,a)=>{if("all"===j.type)return!0;const e=new Date(a,U(t),1);switch(j.type){case"week":{const t=new Date,a=new Date(t);return a.setDate(t.getDate()-7),e>=a&&e<=t}case"month":{const t=j.month??(new Date).getMonth(),a=j.year??(new Date).getFullYear();return e.getMonth()===t&&e.getFullYear()===a}case"fy":{const t=new Date,a=j.fyStartYear??(t.getMonth()>=3?t.getFullYear():t.getFullYear()-1),r=new Date(a,3,1),s=new Date(a+1,2,31);return e>=r&&e<=s}case"cy":{const t=j.year??(new Date).getFullYear();return e.getFullYear()===t}case"custom":return!j.startDate||!j.endDate||e>=j.startDate&&e<=j.endDate;default:return!0}},[j]),U=t=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(t),P=t.useMemo(()=>w.filter(t=>!!z(t.month,t.year)&&(0!==t.pl||0!==t.capitalChanges||t.startingCapital>0)).map(t=>({month:`${t.month} ${t.year}`,capital:t.finalCapital,pl:t.pl,startingCapital:t.startingCapital,capitalChanges:t.capitalChanges,plPercentage:0!==t.startingCapital?t.pl/t.startingCapital*100:0})),[w,z]);t.useEffect(()=>{if(f&&P.length>0){const t=setTimeout(()=>{f(P)},100);return()=>clearTimeout(t)}},[P]),t.useMemo(()=>{var t;let a=(null==(t=P[0])?void 0:t.startingCapital)||0;return P.map(t=>{t.capital>a&&(a=t.capital);const e=0!==a?(a-t.capital)/a*100:0;return{...t,drawdown:e}})},[P]),t.useMemo(()=>{const t=P.map(t=>t.plPercentage),a=(r=3,(e=t).map((t,a)=>{if(a<r-1)return 0;const s=e.slice(a-r+1,a+1),o=s.reduce((t,a)=>t+a,0)/r,n=s.reduce((t,a)=>t+Math.pow(a-o,2),0)/r;return Math.sqrt(n)}));var e,r;return P.map((t,e)=>({...t,volatility:a[e]}))},[P]);const F=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t);return 0===P.length?o.jsx("div",{className:"h-[350px] flex items-center justify-center","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:div:216:6",children:o.jsxs("div",{className:"text-center text-default-500","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:div:217:8",children:[o.jsx("div",{className:"text-lg font-medium mb-2","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:div:218:10",children:"No Portfolio Data"}),o.jsx("div",{className:"text-sm","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:div:219:10",children:"Start trading to see your portfolio performance"})]})}):o.jsx("div",{className:"h-[350px]","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:div:226:4",children:o.jsx(n,{width:"100%",height:"100%","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:ResponsiveContainer:227:6",children:"capital"===_?o.jsxs(i,{data:P,margin:{top:10,right:30,left:30,bottom:30},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:AreaChart:229:10",children:[o.jsx("defs",{"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:defs:233:12",children:o.jsxs("linearGradient",{id:"colorCapital",x1:"0",y1:"0",x2:"0",y2:"1","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:linearGradient:234:14",children:[o.jsx("stop",{offset:"5%",stopColor:"hsl(var(--heroui-primary-500))",stopOpacity:.3,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:stop:235:16"}),o.jsx("stop",{offset:"95%",stopColor:"hsl(var(--heroui-primary-500))",stopOpacity:0,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:stop:236:16"})]})}),o.jsx(c,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--heroui-divider))","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:CartesianGrid:239:12"}),o.jsx(l,{dataKey:"month",axisLine:!1,tickLine:!1,dy:10,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:XAxis:240:12"}),o.jsx(p,{tickFormatter:t=>F(t),axisLine:!1,tickLine:!1,dx:-10,width:80,tick:{fontSize:12},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:YAxis:246:12"}),o.jsx(d,{formatter:(t,a,e)=>{if("Portfolio Value"===a){const a=e.payload,r=a.capitalChanges,s=a.startingCapital,o=a.plPercentage,n=[[F(t),"Portfolio Value"]];return null!=s&&n.push([F(s),"Starting Capital"]),void 0!==r&&0!==r&&n.push([F(r),r>0?"Deposit":"Withdrawal"]),null!=o&&n.push([`${o.toFixed(2)}%`,"Monthly P/L %"]),n}return[F(t),a]},labelFormatter:t=>t,contentStyle:{backgroundColor:"hsl(var(--heroui-content1))",border:"1px solid hsl(var(--heroui-divider))",borderRadius:"8px",padding:"8px 12px"},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Tooltip:254:12"}),o.jsx(m,{"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Legend:285:12"}),o.jsx(h,{type:"monotone",dataKey:"capital",name:"Portfolio Value",stroke:"hsl(var(--heroui-primary))",fillOpacity:1,fill:"url(#colorCapital)",strokeWidth:2,activeDot:{r:6,strokeWidth:2},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Area:286:12"})]}):o.jsxs(i,{data:P,margin:{top:10,right:30,left:30,bottom:30},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:AreaChart:298:10",children:[o.jsx("defs",{"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:defs:302:12",children:o.jsxs("linearGradient",{id:"colorPL",x1:"0",y1:"0",x2:"0",y2:"1","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:linearGradient:303:14",children:[o.jsx("stop",{offset:"5%",stopColor:"hsl(var(--heroui-success-500))",stopOpacity:.3,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:stop:304:16"}),o.jsx("stop",{offset:"95%",stopColor:"hsl(var(--heroui-success-500))",stopOpacity:0,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:stop:305:16"})]})}),o.jsx(c,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--heroui-divider))","data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:CartesianGrid:308:12"}),o.jsx(l,{dataKey:"month",axisLine:!1,tickLine:!1,dy:10,"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:XAxis:309:12"}),o.jsx(p,{tickFormatter:t=>`${t.toFixed(0)}%`,axisLine:!1,tickLine:!1,dx:-10,width:80,tick:{fontSize:12},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:YAxis:315:12"}),o.jsx(d,{formatter:(t,a,e)=>{if("P&L Percentage"===a){const a=e.payload,r=[[`${t.toFixed(2)}%`,"P&L Percentage"]];return void 0!==a.pl&&null!==a.pl&&r.push([F(a.pl),"Total P&L"]),void 0!==a.startingCapital&&null!==a.startingCapital&&r.push([F(a.startingCapital),"Starting Capital"]),r}return[`${t.toFixed(2)}%`,a]},labelFormatter:t=>t,contentStyle:{backgroundColor:"hsl(var(--heroui-content1))",border:"1px solid hsl(var(--heroui-divider))",borderRadius:"8px",padding:"8px 12px"},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Tooltip:323:12"}),o.jsx(m,{"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Legend:348:12"}),o.jsx(h,{type:"monotone",dataKey:"plPercentage",name:"P&L Percentage",stroke:"hsl(var(--heroui-success))",fillOpacity:1,fill:"url(#colorPL)",strokeWidth:2,activeDot:{r:6,strokeWidth:2},"data-locator":"C:\\Users\\anike_jr5dzh1\\Downloads\\nonapi\\prod_test_0.3-master\\src\\components\\analytics\\performance-chart.tsx:Area:349:12"})]})})})};export{x as PerformanceChart};
//# sourceMappingURL=performance-chart-C5i3aLOl.js.map
